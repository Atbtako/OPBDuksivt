select * from book order by book_id asc;
select Code_book, Title_book, Pages from books order by Title_book asc, Pages desc;
select postavka_name, phone, inn from postavki order by inn desc;
select postavka_name, inn,phone, adress, kod_postavki from postavki;
select izdat_name, city, izdatel_id from izdatel;
SELECT b.book_name AS Title_book, b.colvo AS Pages, (SELECT a.name FROM autor a WHERE a.autor_id = b.autor_code) AS Name_author FROM book b;
SELECT b.book_name AS Title_book, b.colvo AS Pages, p.postavka_name AS Name_delivery FROM book b JOIN pokupki pk ON b.book_id = pk.book_id JOIN postavki p ON pk.postav_code = p.kod_postavki;
SELECT b.book_name AS Title_book, b.colvo AS Pages, (SELECT i.izdat_name FROM izdatel i WHERE i.izdatel_id = b.izdatel_id) AS Publish, (SELECT i.city FROM izdatel i WHERE i.izdatel_id = b.izdatel_id) AS City FROM book b;
SELECT company_name, phone, inn FROM postavki WHERE company_name LIKE 'ОАО%';
SELECT b.book_name AS Title_book, b.colvo AS Pages, (SELECT a.name FROM autor a WHERE a.autor_id = b.autor_code) AS Name_author FROM book b WHERE b.book_name LIKE 'Мемуары%';
SELECT name AS Name_author FROM autor WHERE name LIKE 'Иванов%';
SELECT izdat_name AS Publish FROM izdatel WHERE city <> 'Москва';
SELECT b.book_name AS Title_book FROM book b WHERE (SELECT i.izdat_name FROM izdatel i WHERE i.izdatel_id = b.izdatel_id) <> 'Питер-Софт';
SELECT name AS Name_author FROM autor WHERE birthday BETWEEN '1840-01-01' AND '1860-06-01';
SELECT b.book_name AS Title_book, (SELECT pk.kolvo FROM pokupki pk WHERE pk.book_id = b.book_id) AS Amount FROM book b WHERE (SELECT pk.zakup_date FROM pokupki pk WHERE pk.book_id = b.book_id) BETWEEN '2003-03-12' AND '2003-06-15';
SELECT book_name AS Title_book, colvo AS Pages FROM book WHERE colvo BETWEEN 200 AND 300;
SELECT name AS Name_author FROM autor WHERE name LIKE 'В%' OR name LIKE 'Г%';
SELECT b.book_name AS Title_book, (SELECT pk.kolvo FROM pokupki pk WHERE pk.book_id = b.book_id) AS Amount FROM book b WHERE (SELECT pk.postav_code FROM pokupki pk WHERE pk.book_id = b.book_id) IN (3, 7, 9, 11);
SELECT b.book_name AS Title_book FROM book b WHERE (SELECT i.izdat_name FROM izdatel i WHERE i.izdatel_id = b.izdatel_id) IN ('Питер-Софт', 'Альфа', 'Наука');
SELECT b.book_name AS Title_book FROM book b WHERE (SELECT a.name FROM autor a WHERE a.autor_id = b.autor_code) IN ('Толстой Л.Н.', 'Достоевский Ф.М.', 'Пушкин А.С.');
SELECT name AS Name_author FROM autor WHERE name LIKE 'К%';
SELECT izdat_name AS Publish FROM izdatel WHERE izdat_name LIKE '%софт%';
SELECT company_name FROM postavki WHERE company_name LIKE '%ский';
SELECT pk.postav_code AS Code_delivery, pk.zakup_date AS Date_order, b.book_name AS Title_book FROM pokupki pk JOIN book b ON pk.book_id = b.book_id WHERE pk.kolvo > 100 OR pk.price BETWEEN 200 AND 500;
SELECT a.autor_id AS Code_author, a.autor_name AS Name_author, b.book_name AS Title_book FROM autor a JOIN book b ON a.autor_id = b.autor_code JOIN izdatel i ON b.izdatel_id = i.izdatel_id WHERE i.izdatel_id BETWEEN 10 AND 25 AND b.colvo > 120;
SELECT i.izdat_name AS Publish FROM izdatel i JOIN book b ON i.izdatel_id = b.izdatel_id WHERE b.book_name LIKE 'Труды%' AND i.city = 'Новосибирск';
SELECT p.company_name, b.book_name AS Title_book FROM postavki p JOIN pokupki pk ON p.kod_postavki = pk.postav_code JOIN book b ON pk.book_id = b.book_id WHERE pk.zakup_date BETWEEN '2002-01-01' AND '2003-12-31';
SELECT a.autor_name AS Name_author FROM autor a JOIN book b ON a.autor_id = b.autor_code JOIN izdatel i ON b.izdatel_id = i.izdatel_id WHERE i.izdat_name = 'Мир';
SELECT DISTINCT p.company_name FROM postavki p JOIN pokupki pk ON p.kod_postavki = pk.postav_code JOIN book b ON pk.book_id = b.book_id JOIN izdatel i ON b.izdatel_id = i.izdatel_id WHERE i.izdat_name = 'Питер';
SELECT a.autor_name AS Name_author, b.book_name AS Title_book FROM autor a JOIN book b ON a.autor_id = b.autor_code JOIN pokupki pk ON b.book_id = pk.book_id JOIN postavki p ON pk.postav_code = p.kod_postavki WHERE p.company_name = 'ОАО Книготорг';
SELECT b.book_name AS Title_book, (SELECT SUM(pk.kolvo * pk.price) FROM pokupki pk WHERE pk.book_id = b.book_id) AS Total_Cost FROM book b;
SELECT b.book_name AS Title_book, (SELECT pk.price / b.colvo FROM pokupki pk WHERE pk.book_id = b.book_id) AS Cost_Per_Page FROM book b;
SELECT b.book_name AS Title_book, (SELECT pk.price / b.colvo FROM pokupki pk WHERE pk.book_id = b.book_id) AS Cost_Per_Page FROM book b;SELECT name AS Name_author, EXTRACT(YEAR FROM AGE(CURRENT_DATE, birthday)) AS Years_Since_Birth FROM autor;
SELECT SUM(pk.price * pk.kolvo) AS Total_Cost FROM pokupki pk WHERE pk.postav_code = (SELECT kod_postavki FROM postavki WHERE company_name = 'ЗАО Оптторг');
SELECT COUNT(*) AS Total_Purchases FROM pokupki WHERE zakup_date BETWEEN '2003-01-01' AND '2003-02-01';
SELECT AVG(pokupki.price) AS Avg_Cost, AVG(pokupki.kolvo) AS Avg_Amount FROM pokupki, book, autor WHERE pokupki.book_id = book.book_id AND book.autor_code = autor.autor_id AND autor.autor_name = 'Акунин';
SELECT pk.*, b.book_name AS Title_book FROM pokupki pk JOIN book b ON pk.book_id = b.book_id ORDER BY (pk.price * pk.kolvo) ASC LIMIT 1;
SELECT pk.*, b.book_name AS Title_book FROM pokupki pk JOIN book b ON pk.book_id = b.book_id ORDER BY (pk.price * pk.kolvo) DESC LIMIT 1;
SELECT b.book_name AS Title_book, SUM(pk.kolvo * pk.price) AS Itogo FROM pokupki pk JOIN book b ON pk.book_id = b.book_id WHERE pk.zakup_date BETWEEN '2002-01-01' AND '2002-06-01' GROUP BY b.book_name;
SELECT b.book_name AS Title_book, (pk.price / b.colvo) AS One_page FROM pokupki pk JOIN book b ON pk.book_id = b.book_id;
SELECT SUM(pk.price * pk.kolvo) AS Sum_cost FROM pokupki pk WHERE pk.postav_code = (SELECT kod_postavki FROM postavki WHERE company_name = 'ОАО Луч');

