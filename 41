select * from book order by book_id asc;
select Code_book, Title_book, Pages from books order by Title_book asc, Pages desc;
select postavka_name, phone, inn from postavki order by inn desc;
select postavka_name, inn,phone, adress, kod_postavki from postavki;
select izdat_name, city, izdatel_id from izdatel;
SELECT b.book_name AS Title_book, b.colvo AS Pages, (SELECT a.name FROM autor a WHERE a.autor_id = b.autor_code) AS Name_author FROM book b;
SELECT b.book_name AS Title_book, b.colvo AS Pages, (SELECT p.postavka_name FROM postavki p WHERE p.kod_postavki = pk.postav_code) AS Name_delivery FROM book b, pokupki pk WHERE b.book_id = pk.book_id;
SELECT b.book_name AS Title_book, b.colvo AS Pages, (SELECT i.izdat_name FROM izdatel i WHERE i.izdatel_id = b.izdatel_id) AS Publish, (SELECT i.city FROM izdatel i WHERE i.izdatel_id = b.izdatel_id) AS City FROM book b;
SELECT company_name, phone, inn FROM postavki WHERE company_name LIKE 'ОАО%';
SELECT b.book_name AS Title_book, b.colvo AS Pages, (SELECT a.name FROM autor a WHERE a.autor_id = b.autor_code) AS Name_author FROM book b WHERE b.book_name LIKE 'Мемуары%';
SELECT name AS Name_author FROM autor WHERE name LIKE 'Иванов%';
SELECT izdat_name AS Publish FROM izdatel WHERE city <> 'Москва';
SELECT b.book_name AS Title_book FROM book b WHERE (SELECT i.izdat_name FROM izdatel i WHERE i.izdatel_id = b.izdatel_id) <> 'Питер-Софт';
SELECT name AS Name_author FROM autor WHERE birthday BETWEEN '1840-01-01' AND '1860-06-01';
SELECT b.book_name AS Title_book, (SELECT pk.kolvo FROM pokupki pk WHERE pk.book_id = b.book_id) AS Amount FROM book b WHERE (SELECT pk.zakup_date FROM pokupki pk WHERE pk.book_id = b.book_id) BETWEEN '2003-03-12' AND '2003-06-15';
SELECT book_name AS Title_book, colvo AS Pages FROM book WHERE colvo BETWEEN 200 AND 300;
SELECT name AS Name_author FROM autor WHERE name LIKE 'В%' OR name LIKE 'Г%';
SELECT b.book_name AS Title_book, (SELECT pk.kolvo FROM pokupki pk WHERE pk.book_id = b.book_id) AS Amount FROM book b WHERE (SELECT pk.postav_code FROM pokupki pk WHERE pk.book_id = b.book_id) IN (3, 7, 9, 11);
SELECT b.book_name AS Title_book FROM book b WHERE (SELECT i.izdat_name FROM izdatel i WHERE i.izdatel_id = b.izdatel_id) IN ('Питер-Софт', 'Альфа', 'Наука');
SELECT b.book_name AS Title_book FROM book b WHERE (SELECT a.name FROM autor a WHERE a.autor_id = b.autor_code) IN ('Толстой Л.Н.', 'Достоевский Ф.М.', 'Пушкин А.С.');
SELECT name AS Name_author FROM autor WHERE name LIKE 'К%';
SELECT izdat_name AS Publish FROM izdatel WHERE izdat_name LIKE '%софт%';
SELECT company_name FROM postavki WHERE company_name LIKE '%ский';
SELECT pk.postav_code AS Code_delivery, pk.zakup_date AS Date_order, (SELECT b.book_name FROM book b WHERE b.book_id = pk.book_id) AS Title_book  FROM pokupki pk  WHERE pk.kolvo > 100 OR pk.price BETWEEN 200 AND 500;
SELECT a.autor_id AS Code_author, a.autor_name AS Name_author, (SELECT b.book_name FROM book b WHERE b.autor_code = a.autor_id) AS Title_book FROM autor a WHERE a.autor_id IN (SELECT b.autor_code FROM book b WHERE b.izdatel_id IN (SELECT i.izdatel_id FROM izdatel i WHERE i.izdatel_id BETWEEN 10 AND 25) AND b.colvo > 120);
SELECT i.izdat_name AS Publish FROM izdatel i WHERE i.izdatel_id IN (SELECT b.izdatel_id FROM book b WHERE b.book_name LIKE 'Труды%') AND i.city = 'Новосибирск';
SELECT p.company_name, (SELECT b.book_name FROM book b WHERE b.book_id = pk.book_id) AS Title_book FROM postavki p, pokupki pk WHERE p.kod_postavki = pk.postav_code AND pk.zakup_date BETWEEN '2002-01-01' AND '2003-12-31';
SELECT a.autor_name AS Name_author FROM autor a WHERE a.autor_id IN (SELECT b.autor_code FROM book b WHERE b.izdatel_id IN (SELECT i.izdatel_id FROM izdatel i WHERE i.izdat_name = 'Мир'));
SELECT DISTINCT p.company_name FROM postavki p WHERE p.kod_postavki IN (SELECT pk.postav_code FROM pokupki pk WHERE pk.book_id IN (SELECT b.book_id FROM book b WHERE b.izdatel_id IN (SELECT i.izdatel_id FROM izdatel i WHERE i.izdat_name = 'Питер')));
SELECT a.autor_name AS Name_author, b.book_name AS Title_book FROM autor a, book b, pokupki pk, postavki p WHERE a.autor_id = b.autor_code AND b.book_id = pk.book_id AND pk.postav_code = p.kod_postavki AND p.company_name = 'ОАО Книготорг';
SELECT b.book_name AS Title_book, (SELECT SUM(pk.kolvo * pk.price) FROM pokupki pk WHERE pk.book_id = b.book_id) AS Total_Cost FROM book b;
SELECT b.book_name AS Title_book, (SELECT pk.price / b.colvo FROM pokupki pk WHERE pk.book_id = b.book_id) AS Cost_Per_Page FROM book b;
SELECT b.book_name AS Title_book, (SELECT pk.price / b.colvo FROM pokupki pk WHERE pk.book_id = b.book_id) AS Cost_Per_Page FROM book b;SELECT name AS Name_author, EXTRACT(YEAR FROM AGE(CURRENT_DATE, birthday)) AS Years_Since_Birth FROM autor;
SELECT SUM(pk.price * pk.kolvo) AS Total_Cost FROM pokupki pk WHERE pk.postav_code = (SELECT kod_postavki FROM postavki WHERE company_name = 'ЗАО Оптторг');
SELECT COUNT(*) AS Total_Purchases FROM pokupki WHERE zakup_date BETWEEN '2003-01-01' AND '2003-02-01';
SELECT AVG(pokupki.price) AS Avg_Cost, AVG(pokupki.kolvo) AS Avg_Amount FROM pokupki, book, autor WHERE pokupki.book_id = book.book_id AND book.autor_code = autor.autor_id AND autor.autor_name = 'Акунин';
SELECT pk.*, (SELECT b.book_name FROM book b WHERE b.book_id = pk.book_id) AS Title_book FROM pokupki pk ORDER BY (pk.price * pk.kolvo) ASC LIMIT 1;
SELECT pk.*, (SELECT b.book_name FROM book b WHERE b.book_id = pk.book_id) AS Title_book FROM pokupki pk ORDER BY (pk.price * pk.kolvo) DESC LIMIT 1;
SELECT b.book_name AS Title_book, SUM(pk.kolvo * pk.price) AS Itogo FROM pokupki pk, book b WHERE pk.book_id = b.book_id AND pk.zakup_date BETWEEN '2002-01-01' AND '2002-06-01' GROUP BY b.book_name;
SELECT b.book_name AS Title_book, (pk.price / b.colvo) AS One_page FROM pokupki pk, book b WHERE pk.book_id = b.book_id;
SELECT SUM(pk.price * pk.kolvo) AS Sum_cost FROM pokupki pk WHERE pk.postav_code = (SELECT kod_postavki FROM postavki WHERE company_name = 'ОАО Луч');
UPDATE book SET colvo = 300 WHERE autor_code = 56 AND book_name = 'Мемуары';
UPDATE postavki SET adress= 'Нет совпадений' WHERE adress = '';
UPDATE pokupki SET price = price * 1.20 WHERE zakup_date >= DATE_SUB(CURDATE(), INTERVAL 1 MONTH);
SELECT @max_code := MAX(pokup_code) FROM pokupki; SET @new_code := @max_code + 1; INSERT INTO pokupki (pokup_code, postav_type, /* другие поля */) VALUES (@new_code, 'опт', /* другие значения */);
SELECT @max_code := MAX(book_id) FROM book; SET @new_code := @max_code + 1; INSERT INTO book (book_id, book_name, colvo, autor_code, izdatel_id) VALUES (@new_code, 'Наука. Техника. Инновации', 12,39,903362 );
SELECT @max_code := MAX(izdatel_id) FROM izdatel; SET @new_code := @max_code + 1; INSERT INTO izdatel (izdatel_id, izdat_name, city) VALUES (@new_code, 'Наука' ,'Москва');
DELETE FROM pokupki WHERE kolvo = 0;
DELETE FROM autor WHERE autor_name = null;
DELETE FROM postavki WHERE inn = null;
